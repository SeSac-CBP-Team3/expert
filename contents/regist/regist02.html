<!DOCTYPE html>
<html lang="ko">

<head id="head"></head>
<script src="/resources/js/jquery/jquery.1.11.3.min.js"></script>
<!--jquery 필수-->
<body>
    <div id="container" class="sub">
        <!-- 서브 헤더 s -->
        <header id="header" class="header"></header>
        <!-- 서브 헤더 e -->
        <!-- 서브 비주얼 s -->
        <div class="sub_vis sub_vis06">
            <div class="inner">
                <h2 class="sub_ment">
                    <span class="tx">EXPERT ACADEMY</span>
                    <p class="ti">신청하기</p>
                </h2>
            </div>
        </div>
        <!-- 서브 비주얼 e -->
        <div class="contents regist">
            <!-- sub_layout이라는 클래스명을 지우고 페이지별 클래스 네임을 지정해줄 것 -->
            <!-- ................ content s  ................................ -->
            <div class="inner">
                <div class="path_wrap clear">
                    <p class="path clear">
                        <a class="depth depth1" href="/">HOME</a>
                        <span class="depth depth2">공개과정</span>
                        <span class="depth depth3">신청하기</span>
                    </p>
                </div>
                <!-- 메뉴바 s -->
                <div class="menu">
                    <ul class="menu-bar clear">
                        <li class="bar">01 이용약관<span></span></li>
                        <li class="bar on">02 정보입력<span></span></li>
                        <li class="bar">03 신청완료</li>
                    </ul>
                </div>
                
                <!-- 메뉴바 e -->
                <!-- 기본사항 s -->
                <div class="line_box mat50">
                    <h4 class="ti">01 기본 사항</h4>
                </div>
                <div class="div_table">
                    <div class="tr">
                        <dl>
                            <dt><p>교육과정<i class="rq">*</i></p></dt>
                            <dd><p>[LIVE] 교육담당자 HRD 향상과정</p></dd>
                        </dl>
                    </div>                    
                    <div class="tr">
                        <dl>
                            <dt><p>교육기간<i class="rq">*</i></p></dt>
                            <dd><p>
                                <select name="con_date" id="con_date" class="select_box" required="required">
                                <option value="">선택</option>
                                <option value="1">2022.01.01~2022.01.01</option>
                                <option value="2">2022.02.01~2022.02.01</option>
                                <option value="3">2022.03.01~2022.03.01</option>
                            </select>
                        </p></dd>
                        </dl>
                    </div>
                    <div class="tr">
                        <dl>
                            <dt><p>교육인원</p></dt>
                            <dd><p><span class="c_light" id="person">1</span>명</p></dd>
                        </dl>
                    </div>
                </div>
                <!-- 기본사항 e -->
                <!-- 교육생정보 s -->
                <div class="line_box mat50">
                    <h4 class="ti">02 교육생 정보
                        <span class="h4_tx">실제 교육 참가자의 정보를 입력해 주세요.</span>
                    </h4>
                </div>
                <div class="student_wrap">
                    <div class="btn_wrap tar">
                        <a href="#none" class="hover_btn00" id="addBtn">교육인원 추가<i class="plus">+</i></a>
                        <a href="#none" class="hover_btn00" id="delBtn">선택 삭제</a>
                    </div>
                    <div class="student_box mat10">
                        <div class="chk_sec">
                            <input type="checkbox" id="student_chk" name="student_chk" >
                            <label for="student_chk"></label>
                        </div>
                        <div class="table_sec">
                            <div class="div_table addBorder">
                                <div class="tr tr50">
                                    <dl>
                                        <dt><p><label for="con_name">성명<i class="rq">*</i></label></p></dt>
                                        <dd><p><input type="text" id="con_name" name="con_name" class="con_name" placeholder="성함" maxlength="20" required="required"></p></dd>
                                    </dl>
                                    <dl>
                                        <dt><p><label for="con_birthday">생년월일<i class="rq">*</i></label></p></dt>
                                        <dd ><p><input type="date" value="birthday" id="con_birthday" class="con_birthday" ></p></dd>
                                    </dl>
                                </div>
                                <div class="tr tr50">
                                    <dl>
                                        <dt><p><label for="con_tel">연락처<i class="rq">*</i></label></p></dt>
                                        <dd><p><input type="text" id="con_tel" name="etc_3" class="con_tel" placeholder="연락처" maxlength="13" required="required"></p></dd>
                                    </dl>
                                    <dl>
                                        <dt><p><label for="con_email">E-mail<i class="rq">*</i></label></p></dt>
                                        <dd><p><input type="text" id="con_email" name="etc_3" class="con_email" placeholder="E-mail" maxlength="30" required="required"></p></dd>
                                    </dl>
                                </div>
                                <div class="tr">
                                    <dl>
                                        <dt><p><label for="con_com">회사명</label></p></dt>
                                        <dd><p><input type="text" id="con_com" name="etc_3" class="con_com" placeholder="회사명" maxlength="30"></p></dd>
                                    </dl>
                                </div>
                                <div class="tr tr50">
                                    <dl>
                                        <dt><p><label for="con_divi">부서명</label></p></dt>
                                        <dd><p><input type="text" id="con_divi" name="etc_3" class="com_divi" placeholder="부서명" maxlength="20"></p></dd>
                                    </dl>
                                    <dl>
                                        <dt><p><label for="con_posi">직위</label></p></dt>
                                        <dd><p><input type="text" id="con_posi" name="etc_3" class="con_posi" placeholder="직위" maxlength="20"></p></dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 교육생정보 e -->
                <!-- 결제금액 s -->
                <div class="line_box mat50">
                    <h4 class="ti">03 결제 금액</h4>
                </div>
                <div class="div_table">
                    <div class="tr">
                        <dl>
                            <dt><p>3명 이상 할인(5%)<i class="rq"></i></p></dt>
                            <dd><p id="5price">0원</p></dd>
                        </dl>
                    </div>                    
                    <div class="tr">
                        <dl>
                            <dt><p>5명 이상 할인(10%)<i class="rq"></i></p></dt>
                            <dd><p id="10price">0원</p></dd>
                        </dl>
                    </div>
                    <div class="tr">
                        <dl>
                            <dt><p>총 금액</p></dt>
                            <dd><p id="totalPrice">0원</p></dd>
                        </dl>
                    </div>
                    <div class="tr">
                        <dl>
                            <dt><p>결제방법 선택<i class="rq">*</i></p></dt>
                            <dd><p>
                                <input type="checkbox" id="checkboxA" name="checkbox">
                                <label for="checkboxA">현금입금(계산서)</label>
                                <input type="checkbox" id="checkboxB" name="checkbox">
                                <label for="checkboxB">카드결제(문자전송)</label>
                                <input type="checkbox" id="checkboxC" name="checkbox">
                                <label for="checkboxC">카드결제(현장방문)</label>
                                <input type="checkbox" id="checkboxD" name="checkbox">
                                <label for="checkboxD">무료교육</label>
                            </p></dd>
                        </dl>
                    </div>
                </div>
                <!-- 결제금액 e -->
                <!-- 신청 버튼 s -->
                <div class="btn_wrap tac mat50">
                    <a href="javascript:;" class="hover_btn05" id="request">신청하기<span></span></a>
                </div>
                <!-- 신청 버튼 e -->
            </div>

        </div>
        <!-- ................ content e  ................................ -->

        <!--footer s-->
        <footer id="footer"></footer>
        <div id="layer_popup"></div>
        <!--footer e-->
    </div>
    </div>

    <script>
        $("#head").load("/inc/head_contents.html");
        $("#header").load("/inc/header_contents.html");
        $("#footer").load("/inc/footer.html");
        $("#layer_popup").load("/inc/layer_popup.html");
    </script>
    <!-- 교육인원추가 스크립트 s -->
    <script>
    
        const studentWrap = document.getElementsByClassName('student_wrap')[0];
        const studentBox = document.getElementsByClassName('student_box')[0];
        const add_btn = document.getElementById('addBtn');
        // 교육인원 추가 s
        function addStudent() {
            const div = document.createElement('div')
            div.innerHTML = studentBox.outerHTML;
            studentWrap.appendChild(div);

            const studentWraps = document.querySelectorAll('.student_wrap .student_box').length;
            console.log(studentWraps);
            for (let i =1 ; i < studentWraps ; i++) {
                div.setAttribute("id",`student_box${i}`); // 추가된div테이블 ID생성
                let chkBox = document.querySelector(`#student_box${i} input`)
                let chkBoxLbl = document.querySelector(`#student_box${i} label`)
                console.log(chkBox)
                console.log(chkBoxLbl)
                chkBox.id = `student_chk${i}`;
                chkBox.name = `student_chk${i}`;
                chkBoxLbl.setAttribute("for", `student_chk${i}`);
                // 추가된 div테이블에 체크박스 input : id, name / label for값 설정
                
                // div안 input-id, label-for 속성추가 s
                let conNameLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr>dl>dt>p>label`
                ); // label 성명
                let conNameInp = document.querySelector(
                    `#student_box${i} .table_sec .tr>dl>dd>p>input`
                ); // input 성명
                let conBirthLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr>dl:nth-child(2)>dt>p>label`
                ); // label 생년월일
                let conBirthInp = document.querySelector(
                    `#student_box${i} .table_sec .tr>dl:nth-child(2)>dd>p>input`
                ); // input 생년월일
                let conTelLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(2)>dl>dt>p>label`
                ); // label 연락처
                let conTelInp = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(2)>dl>dd>p>input`
                ); // input 연락처
                let conEmailLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(2)>dl:nth-child(2)>dt>p>label`
                ); // label 이메일
                let conEmailInp = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(2)>dl:nth-child(2)>dd>p>input`
                ); // input 이메일
                let conComLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(3)>dl>dt>p>label`
                ); // label 회사명
                let conComInp = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(3)>dl>dd>p>input`
                ); // input 이메일
                let conDiviLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(4)>dl>dt>p>label`
                ); // label 부서명
                let conDiviInp = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(4)>dl>dd>p>input`
                ); // input 부서명
                let conPosiLbl = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(4)>dl:nth-child(2)>dt>p>label`
                ); // label 직위
                let conPosiInp = document.querySelector(
                    `#student_box${i} .table_sec .tr:nth-child(4)>dl:nth-child(2)>dd>p>input`
                ); // input 직위

                console.log(conEmailInp);

                conNameLbl.setAttribute("for", `con_name${i}`);
                conNameInp.id = `con_name${i}`;
                conBirthLbl.setAttribute("for", `con_birthday${i}`)
                conBirthInp.id = `con_birthday${i}`;
                conTelLbl.setAttribute("for", `con_tel${i}`);
                conTelInp.id = `con_tel${i}`;
                conEmailLbl.setAttribute("for", `con_email${i}`);
                conEmailInp.id = `con_email${i}`;
                conComLbl.setAttribute("for", `con_com${i}`);
                conComInp.id = `con_com${i}`;
                conDiviLbl.setAttribute("for", `con_divi${i}`);
                conDiviInp.id = `con_divi${i}`;
                conPosiLbl.setAttribute("for", `con_posi${i}`);
                conPosiInp.id = `con_posi${i}`;
                // div안 input-id, label-for 속성추가 e
            }
        }
        // 교육인원 추가 e
        // 교육인원 삭제 s
        function delStudent() {
            const addedStudentWraps = document.querySelectorAll('.student_wrap .student_box').length;
            console.log(addedStudentWraps);
            for (let i=1; i<addedStudentWraps; i++) {
                let checkedStatus = document.querySelector(`input[id=student_chk${i}]`).checked;
                console.log(checkedStatus);
                console.log(document.querySelector(`input[id=student_chk${i}]`))

                if (checkedStatus == true) {
                    document.querySelector(`#student_box${i} > .student_box`).classList.add('hide');
                }
            }
        }
        // 교육인원 삭제 e

        // 교육인원수, 총 금액 증감 s
        function countFnc() {
            const personCount = document.getElementById('person'); // 교육인원수 n명
            const price5per = document.getElementById('5price'); // 5%할인금액
            const price10per = document.getElementById('10price'); // 10%할인금액
            const totalPrice = document.getElementById('totalPrice'); // 총금액

            const number = personCount.innerText;
            const addedStudentWraps = document.querySelectorAll('.student_wrap .student_box').length;
            const dpLeng = document.querySelectorAll('.dp').length; 
            console.log(addedStudentWraps);
            console.log(dpLeng);
            
            personCount.innerText = addedStudentWraps - dpLeng;
            // totalPrice.innerText = (addedStudentWraps - dpLeng) * 50000 +`원`;
            if ( addedStudentWraps >= 3 && addedStudentWraps < 5 ) {
                price5per.innerText = ((addedStudentWraps - dpLeng) * 50000) * 0.95+`원`;
                totalPrice.innerText = ((addedStudentWraps - dpLeng) * 50000) * 0.95+`원`;
            } else if ( addedStudentWraps >= 5 ) {
                price10per.innerText = ((addedStudentWraps - dpLeng) * 50000) * 0.9+`원`;
                price5per.innerText = `0원`;
                totalPrice.innerText = ((addedStudentWraps - dpLeng) * 50000) * 0.9+`원`;
            } else if (addedStudentWraps < 3 ) {
                totalPrice.innerText = (addedStudentWraps - dpLeng) * 50000 +`원`;
            }
        }
        
        // 교육인원수, 총 금액 증감 e
        add_btn.addEventListener('click', addStudent);
        delBtn.addEventListener('click', delStudent);    
        add_btn.addEventListener('click',  countFnc);
        delBtn.addEventListener('click', countFnc);    
    </script>
    <!-- 교육인원추가 스크립트 e -->
    
    <!-- 신청하기 스크립트 s -->
    <script type="text/javascript">
        function check_save() {
            // let aaa = $('input[name=con_name]').length
            //교육기간
            if ($('.select_box').val() == "") {
                alert('교육기간을 선택하세요.');
                $('.select_box').focus();
                return false;
            }
            //성명
            if ($('.con_name').val() == "") {
                alert('성명을 입력하세요.');
                $('.con_name').focus();
                return false;
            }
            //생년월일
            if ($('.con_birthday').val() == "") {
                alert('생년월일을 입력하세요.');
                $('.birth_day').focus();
                return false;
            }
            //연락처
            var mobile1 = $('.con_tel').val();
            
            if (mobile1 == "" || mobile1.length !== 13) {
                alert("휴대폰 번호 형식에 맞게 입력해 주세요. ex. 010-1234-5678");
                $('.con_tel').focus();
                return false;
            }
            //이메일
            var email01 = $('.con_email').val();
            if (email01 == "" || email01.indexOf("@") == -1 || email01.indexOf(".") == -1 ) {
                console.log(email01);
                console.log(email01.indexOf("@"))
                alert("E-mail 형식에 맞게 입력해 주세요.");
                $('.con_email').focus();
                return false;
            }
            //결제방법
            var payWay1 = $("input:checkbox[id=checkboxA]:checked");
            var payWay2 = $("input:checkbox[id=checkboxB]:checked");
            var payWay3 = $("input:checkbox[id=checkboxC]:checked");
            var payWay4 = $("input:checkbox[id=checkboxD]:checked");

            if ( payWay1.length < 1 && payWay2.length < 1 && payWay3.length < 1 && payWay4.length < 1 ) {
                alert('결제방법을 선택해주세요.');
                $('#radioA').focus();
                return false;
            }
            
            $('#form_input').submit();
        }
        const request = document.getElementById('request');
        request.addEventListener('click', check_save);
    </script>
    <!-- 신청하기 스크립트 e -->
</body>

</html>
